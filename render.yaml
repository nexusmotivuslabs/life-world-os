# Render Blueprint: Life World OS
# Database: use Supabase (not Render). Set DATABASE_URL and JWT_SECRET in the backend service.
# See docs/RENDER_SUPABASE_DEPLOYMENT.md for full steps.

services:
  # Backend API (Node/Express + Prisma)
  - type: web
    name: life-world-os-backend
    runtime: node
    rootDir: apps/backend
    buildCommand: npm ci && npx prisma generate && npm run build
    startCommand: npx prisma migrate deploy && npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        sync: false
        # Set in Render Dashboard: Supabase connection string
      - key: JWT_SECRET
        sync: false
        # Set in Dashboard: min 32 chars (e.g. openssl rand -base64 32)
      - key: CORS_ORIGINS
        sync: false
        # Set in Dashboard after frontend deploy: https://life-world-os-frontend.onrender.com

  # Frontend (React/Vite static build)
  - type: static
    name: life-world-os-frontend
    rootDir: apps/frontend
    buildCommand: npm ci && npm run build
    publishPath: dist
    envVars:
      - key: VITE_API_URL
        sync: false
        # Set in Render Dashboard to backend URL: https://life-world-os-backend.onrender.com
