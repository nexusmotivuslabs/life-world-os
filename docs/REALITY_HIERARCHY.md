# Reality Hierarchy Documentation

## Overview

The Life World OS implements a strict hierarchical ontology with **REALITY** as the single immutable root. All laws, principles, and frameworks trace back to REALITY, providing a complete ontological view that supports artifacts and knowledge organization.

## Hierarchy Structure

```
REALITY (immutable root, displayed as "ROOT")
│
├── CONSTRAINTS_OF_REALITY (immutable, FOUNDATIONAL)
│   ├── LAWS (immutable, FOUNDATIONAL)
│   │   ├── Fundamental Laws (FUNDAMENTAL)
│   │   │   ├── LAW_OF_COMPOUNDING
│   │   │   ├── LAW_OF_ENTROPY
│   │   │   ├── LAW_OF_TIME
│   │   │   ├── LAW_OF_ENERGY
│   │   │   └── LAW_OF_CAUSE_EFFECT
│   │   ├── 48 Laws of Power (POWER)
│   │   │   └── [Organized by domain: MONEY, ENERGY, etc.]
│   │   ├── Bible Laws (BIBLICAL)
│   │   │   └── [Organized by domain: MONEY, INVESTMENT, ENERGY, etc.]
│   │   ├── Strategic Laws (STRATEGIC)
│   │   │   ├── LAW_OF_LEVERAGE
│   │   │   └── LAW_OF_MARGIN_OF_SAFETY
│   │   └── Systemic Laws (SYSTEMIC)
│   │       ├── LAW_OF_FEEDBACK_LOOPS
│   │       └── LAW_OF_FIRST_PRINCIPLES
│   │
│   ├── PRINCIPLES (immutable, FOUNDATIONAL)
│   │   ├── Strategic Principles (STRATEGIC)
│   │   │   ├── LEVERAGE
│   │   │   ├── MARGIN_OF_SAFETY
│   │   │   ├── INVERSION
│   │   │   ├── OPPORTUNITY_COST
│   │   │   └── SYSTEMS_THINKING
│   │   ├── Systemic Principles (SYSTEMIC)
│   │   │   ├── FIRST_PRINCIPLES
│   │   │   ├── FEEDBACK_LOOPS
│   │   │   ├── EMERGENCE
│   │   │   ├── ADAPTATION
│   │   │   └── HIERARCHY
│   │   └── Cross-System Modifiers (CROSS_SYSTEM)
│   │       ├── TRUST (principle + modifier)
│   │       ├── REPUTATION (principle + modifier)
│   │       ├── OPTIONALITY (principle + modifier)
│   │       └── ENERGY_RESERVE (principle + modifier)
│   │
│   └── FRAMEWORKS (immutable, FOUNDATIONAL)
│       ├── Pareto Principle (80/20 Rule) (STRATEGIC)
│       └── Domain Application Framework (STRATEGIC)
│
├── AGENTS (immutable, FOUNDATIONAL)
│   └── [Agent types and capabilities]
│
├── ENVIRONMENTS (immutable, FOUNDATIONAL)
│   └── [Environment types]
│
├── RESOURCES (immutable, FOUNDATIONAL)
│   └── ENGINES
│       └── [Engine types]
│
├── VALUE (immutable, FOUNDATIONAL)
│   └── FINANCE (system)
│       └── [Finance categories]
│
└── SYSTEMS (immutable, FOUNDATIONAL)
    ├── SURVIVAL_TIER
    │   └── HEALTH
    │       ├── Universal Concept: BIOLOGY
    │       │   ├── LAWS (branch → references to global laws)
    │       │   │   ├── LAW_OF_ENTROPY (ref)
    │       │   │   ├── LAW_OF_ENERGY (ref)
    │       │   │   ├── LAW_OF_CAUSE_EFFECT (ref)
    │       │   │   └── Biblical Laws: ENERGY (ref)
    │       │   ├── PRINCIPLES (branch → references to global principles)
    │       │   │   ├── MARGIN_OF_SAFETY (ref)
    │       │   │   ├── SYSTEMS_THINKING (ref)
    │       │   │   ├── FEEDBACK_LOOPS (ref)
    │       │   │   └── ADAPTATION (ref)
    │       │   ├── FRAMEWORKS (branch → references to global frameworks)
    │       │   │   ├── GOAL_HIERARCHY_FRAMEWORK (ref)
    │       │   │   └── RISK_ASSESSMENT_FRAMEWORK (ref)
    │       │   └── [Domain pathways: ENERGY, NEUROSCIENCE, ...]
    │       └── [Sub-systems: Capacity, Recovery, Resilience]
    │
    ├── STABILITY_TIER
    │   ├── MONEY
    │   │   ├── Universal Concept: MONEY
    │   │   │   ├── LAWS (branch)
    │   │   │   │   ├── LAW_OF_COMPOUNDING (ref)
    │   │   │   │   ├── LAW_OF_TIME (ref)
    │   │   │   │   ├── LAW_OF_CAUSE_EFFECT (ref)
    │   │   │   │   ├── 48 Laws of Power: MONEY (ref)
    │   │   │   │   ├── Biblical Laws: MONEY (ref)
    │   │   │   │   ├── Biblical Laws: INVESTMENT (ref)
    │   │   │   │   ├── Biblical Laws: STEWARDSHIP (ref)
    │   │   │   │   └── Biblical Laws: GENEROSITY (ref)
    │   │   │   ├── PRINCIPLES (branch)
    │   │   │   │   ├── LEVERAGE (ref)
    │   │   │   │   ├── MARGIN_OF_SAFETY (ref)
    │   │   │   │   ├── OPPORTUNITY_COST (ref)
    │   │   │   │   ├── SYSTEMS_THINKING (ref)
    │   │   │   │   └── FEEDBACK_LOOPS (ref)
    │   │   │   ├── FRAMEWORKS (branch)
    │   │   │   │   ├── PARETO_PRINCIPLE (ref)
    │   │   │   │   ├── RISK_ASSESSMENT_FRAMEWORK (ref)
    │   │   │   │   └── DECISION_MATRIX (ref)
    │   │   │   └── [Domain pathways: INVESTMENT, CASH_FLOW, CAPITAL]
    │   │   └── [Sub-systems: Products, Agents, Teams]
    │   └── ENERGY
    │       ├── Universal Concept: ENERGY
    │       │   ├── LAWS / PRINCIPLES / FRAMEWORKS (branches with refs)
    │       │   └── [Domain pathways]
    │       └── [Sub-systems: States, Levels, Buffs]
    │
    ├── GROWTH_TIER
    │   ├── EDUCATION
    │   │   └── Universal Concept: LEARNING (+ LAWS / PRINCIPLES / FRAMEWORKS)
    │   ├── INVESTMENT
    │   │   └── Universal Concept: INVESTMENT (+ LAWS / PRINCIPLES / FRAMEWORKS)
    │   └── TRAINING
    │       └── Universal Concept: TRAINING (+ LAWS / PRINCIPLES / FRAMEWORKS)
    │
    ├── LEVERAGE_TIER
    │   └── [Future systems]
    │
    ├── EXPRESSION_TIER
    │   ├── TRAVEL
    │   │   └── Universal Concept: TRAVEL (+ LAWS / PRINCIPLES / FRAMEWORKS)
    │   └── MEANING
    │       └── Universal Concept: MEANING (+ LAWS / PRINCIPLES / FRAMEWORKS)
    │
    └── CROSS_SYSTEM_STATES
        ├── TRUST (+ Universal Concept with LAWS / PRINCIPLES / FRAMEWORKS)
        ├── REPUTATION (+ Universal Concept with LAWS / PRINCIPLES / FRAMEWORKS)
        ├── OPTIONALITY (+ Universal Concept with LAWS / PRINCIPLES / FRAMEWORKS)
        └── ENERGY_RESERVE (+ Universal Concept with LAWS / PRINCIPLES / FRAMEWORKS)
```

## Category System

Laws and principles are organized using a **category field** that replaces the previous weight-based system (super_heavy, heavy, light). Categories provide semantic meaning and enable better organization.

### Category Types

- **FOUNDATIONAL** - Core structure nodes (REALITY, CONSTRAINTS_OF_REALITY, LAWS, PRINCIPLES, FRAMEWORKS, SYSTEMS)
- **FUNDAMENTAL** - Basic immutable laws that govern reality (Compounding, Entropy, Time, Energy, Cause-Effect)
- **POWER** - 48 Laws of Power applied across domains
- **BIBLICAL** - Bible Laws and biblical principles applied across domains
- **STRATEGIC** - Strategic principles and frameworks (Leverage, Margin of Safety, Inversion, Pareto Principle)
- **SYSTEMIC** - Systemic principles (First Principles, Feedback Loops, Emergence, Adaptation, Hierarchy)
- **CROSS_SYSTEM** - Cross-system state modifiers (Trust, Reputation, Optionality, Energy Reserve) - act as both principles and system modifiers
- **SYSTEM_TIER** - System tier categories (Survival, Stability, Growth, Leverage, Expression, Cross-System States)
- **SYSTEM** - Individual systems and sub-systems (Health, Money, Energy, etc.)

## Universal Concept Branches (Per-System)

Every system in the hierarchy has a **Universal Concept** node (e.g. BIOLOGY for Health, MONEY for Finance). Under each universal concept, the first three branches are always:

1. **LAWS** - Fundamental, Power, and Biblical laws that apply to this system
2. **PRINCIPLES** - Strategic, systemic, and cross-system principles that apply
3. **FRAMEWORKS** - Practical frameworks for applying laws and principles

These branches contain **reference nodes** that point to global law/principle/framework nodes under `CONSTRAINTS_OF_REALITY`. Each reference node has `metadata.isReference = true` and `metadata.sourceRealityNodeId` linking back to the canonical global node. This avoids data duplication while making each system's tree self-contained and navigable.

After the three branch nodes, system-specific **domain pathways** follow (e.g. INVESTMENT, CASH_FLOW, CAPITAL for finance; ENERGY, NEUROSCIENCE, RESPIRATORY for health).

### Mapping Configuration

The system-to-concept mapping is defined in `apps/backend/src/config/systemUniversalConceptConfig.ts`. It specifies, for each system ID, which fundamental laws, Power Law domains, Bible Law domains, strategic/systemic/cross-system principles, and frameworks apply. The seed script (`seedRealityHierarchy.ts`) reads this mapping to create the branch and reference nodes.

### Artifact Alignment

The backend mapping is aligned with the frontend `ARTIFACT_SYSTEM_MAP` in `apps/frontend/src/config/artifactSystemConfig.ts`. The canonical backend system ID for the finance system is `money`; the frontend uses `finance`. The config exports a `getCanonicalSystemId()` helper for translation.

## Database Schema

### PowerLaw Model

```prisma
model PowerLaw {
  id                  String         @id @default(uuid())
  lawNumber           Int
  title               String
  originalDescription String
  domain              PowerLawDomain
  domainApplication   String
  category            String?        // NEW: Category field
  strategies          Json
  examples            Json?
  warnings            Json?
  counterStrategies   Json?
  order               Int
  createdAt           DateTime
  updatedAt           DateTime

  @@unique([domain, lawNumber])
  @@index([domain])
  @@index([lawNumber])
  @@index([category])  // NEW: Index on category
}
```

### BibleLaw Model

```prisma
model BibleLaw {
  id                    String         @id @default(uuid())
  lawNumber             Int
  title                 String
  scriptureReference    String
  originalText          String?
  domain                BibleLawDomain
  domainApplication     String
  category              String?        // NEW: Category field
  principles            Json
  practicalApplications Json
  examples              Json?
  warnings              Json?
  relatedVerses         Json?
  order                 Int
  createdAt             DateTime
  updatedAt             DateTime

  @@unique([domain, lawNumber])
  @@index([domain])
  @@index([lawNumber])
  @@index([category])  // NEW: Index on category
}
```

## API Endpoints

### Power Laws

- `GET /api/power-laws` - List all power laws (optional filters: `domain`, `category`)
- `GET /api/power-laws/domains` - Get all domains with counts
- `GET /api/power-laws/categories` - Get all categories with counts (NEW)
- `GET /api/power-laws/:id` - Get specific law by ID
- `GET /api/power-laws/by-number/:lawNumber` - Get law by number and domain

### Bible Laws

- `GET /api/bible-laws` - List all Bible laws (optional filters: `domain`, `category`)
- `GET /api/bible-laws/domains` - Get all domains with counts
- `GET /api/bible-laws/categories` - Get all categories with counts (NEW)
- `GET /api/bible-laws/:id` - Get specific law by ID
- `GET /api/bible-laws/by-number/:lawNumber` - Get law by number and domain

## Frontend Integration

The hierarchy tree is displayed in the Knowledge Plane under "Hierarchy Tree" (`/knowledge/hierarchy`). The component:

- Shows the complete hierarchy from REALITY down to individual laws
- Supports expandable/collapsible nodes
- Displays category badges for visual organization
- Shows immutable indicators for foundational nodes
- Supports artifacts (ready for future expansion)

## Artifact Support

The hierarchy structure is designed to support artifacts. The `TreeNode` interface includes an `artifact` type, and the structure can be extended to include:

- Artifacts linked to specific laws or principles
- Artifact collections organized by category
- Artifact metadata and relationships

## Migration Notes

### From Weight-Based to Category-Based

The previous system used weight descriptors (super_heavy, heavy, light) to organize laws. The new system uses semantic categories:

- **Old**: Weight-based organization (super_heavy, heavy, light)
- **New**: Category-based organization (FOUNDATIONAL, FUNDAMENTAL, POWER, BIBLICAL, STRATEGIC, SYSTEMIC)

### Data Migration

When migrating existing data:
1. All existing Power Laws are assigned `category: 'POWER'`
2. All existing Bible Laws are assigned `category: 'BIBLICAL'`
3. Fundamental laws are explicitly created with `category: 'FUNDAMENTAL'`
4. Strategic and Systemic laws are explicitly created with their respective categories

## Key Invariants

1. **REALITY is the single root** - Only one node has `type === 'reality'` and no parent
2. **All nodes trace to REALITY** - Every law, principle, and framework must have a valid path to REALITY
3. **Categories are semantic** - Categories provide meaning, not just weight/importance
4. **Immutable foundational nodes** - REALITY, CONSTRAINTS_OF_REALITY, LAWS, PRINCIPLES, FRAMEWORKS are immutable
5. **Category consistency** - All laws within a category share semantic meaning

## Future Extensions

The structure supports:
- **Artifacts** - Knowledge artifacts linked to laws and principles
- **Relationships** - Cross-references between laws, principles, and frameworks
- **Versioning** - Historical versions of laws and principles
- **Annotations** - User annotations and notes on laws
- **Collections** - Curated collections of laws by theme or application


